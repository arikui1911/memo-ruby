gem 'test-unit'
require 'test/unit'
require 'tmpdir'
require 'fileutils'
require 'memo/util'

class TestUtil < Test::Unit::TestCase
  test '#make_memo_list' do
    Dir.mktmpdir do |dir|
      files = ['hoge.md',
               'piyo.md',
               '.dot.md',
               'fuga.rb']
      FileUtils.touch files.map{|x| File.join(dir, x) }
      assert_equal(['hoge.md',
                    'piyo.md'],
                   Memo::Util.make_memo_list_from(dir))
    end
  end

  sub_test_case '#memo_pattern_matcher' do
    test 'always matches' do
      m = Memo::Util.memo_pattern_matcher(nil)
      assert m[Object.new]
      assert m[666]
      assert m['hoge']
    end

    test 'regexp matcher' do
      m = Memo::Util.memo_pattern_matcher('^.a.', true)
      assert !m['foo']
      assert  m['bar']
      assert  m['baz']
    end

    test 'partial matcher' do
      m = Memo::Util.memo_pattern_matcher('Ru')
      assert  m['Ruby']
      assert !m['Perl']
      assert  m['Rust']
      assert  m['JRuby']
    end
  end

  sub_test_case '#take_headline' do
  end
end
